{
  "id": "lesson_03_between",
  "title": "BETWEEN e IN",
  "lesson_type": "interactive_sql",
  "objective": "Filter values within a range using BETWEEN.",
  "prerequisites": [
    "lesson_02_combining_conditions"
  ],
  "estimated_minutes": 12,
  "content_markdown": "**Contexto de negócio**: Relatórios frequentemente exigem filtros de intervalo (\"pedidos no 1º trimestre\") e filtros de lista (\"clientes nestes países\"). `BETWEEN` e `IN` tornam isso mais limpo do que encadear várias condições `AND`/`OR`.\r\n\r\n**Após esta aula, o aluno será capaz de**:\r\n- Filtrar um intervalo numérico usando `BETWEEN`.\r\n- Filtrar um intervalo de datas usando `BETWEEN`.\r\n- Filtrar uma coluna contendo uma lista de valores usando `IN`.\r\n- Combinar `IN` com `AND` para filtragem de múltiplas condições.",
  "dataset_context": {
    "business_model": "core_sql",
    "tables_used": [
      "filtering.orders"
    ],
    "scenario": "Filter ranges with BETWEEN."
  },
  "exercises": [
    {
      "id": "ch1_amount_between",
      "title": "Challenge 1: Amount between 50 and 150",
      "prompt_markdown": "### Objective\nReturn rows from `filtering.orders` where `amount` is between 50 and 150 (inclusive).",
      "starter_query": "-- (editor vazio)",
      "solution_query": "SELECT *\nFROM filtering.orders\nWHERE amount BETWEEN 50 AND 150;",
      "validation_type": "result_match",
      "expected_result": [
        {
          "id": 4,
          "customer_id": 4,
          "amount": 120,
          "city": "Mexico City",
          "country": "Mexico",
          "status": "approved",
          "order_date": "2023-11-05",
          "delivery_date": "2023-11-08"
        },
        {
          "id": 8,
          "customer_id": 8,
          "amount": 90,
          "city": "Vancouver",
          "country": "Canada",
          "status": "pending",
          "order_date": "2023-12-10",
          "delivery_date": null
        },
        {
          "id": 13,
          "customer_id": 2,
          "amount": 75,
          "city": "LA",
          "country": "USA",
          "status": "approved",
          "order_date": "2023-03-05",
          "delivery_date": "2023-03-08"
        },
        {
          "id": 17,
          "customer_id": 8,
          "amount": 110,
          "city": "Calgary",
          "country": "Canada",
          "status": "approved",
          "order_date": "2023-11-28",
          "delivery_date": "2023-12-01"
        },
        {
          "id": 18,
          "customer_id": 5,
          "amount": 95,
          "city": "Brasilia",
          "country": "Brazil",
          "status": "approved",
          "order_date": "2024-02-20",
          "delivery_date": "2024-02-23"
        }
      ],
      "hint_level_1": "BETWEEN is inclusive on both ends.",
      "validation": {
        "order_matters": false
      },
      "success_criteria": {
        "objective": "Return orders with amount between 50 and 150",
        "expected_columns": [
          "id",
          "customer_id",
          "amount",
          "city",
          "country",
          "status",
          "order_date",
          "delivery_date"
        ],
        "notes": []
      },
      "hint_level_2": "WHERE amount BETWEEN 50 AND 150"
    },
    {
      "id": "ch2_date_between",
      "title": "Challenge 2: Order date in 2023",
      "prompt_markdown": "### Objective\nReturn rows from filtering.orders where order_date is between '2023-01-01' and '2023-12-31' (inclusive).",
      "starter_query": "-- (editor vazio)",
      "solution_query": "SELECT *\nFROM filtering.orders\nWHERE order_date BETWEEN '2023-01-01' AND '2023-12-31';",
      "validation_type": "result_match",
      "expected_result": [
        {
          "id": 3,
          "customer_id": 3,
          "amount": 350,
          "city": "Toronto",
          "country": "Canada",
          "status": "approved",
          "order_date": "2023-06-20",
          "delivery_date": "2023-06-25"
        },
        {
          "id": 4,
          "customer_id": 4,
          "amount": 120,
          "city": "Mexico City",
          "country": "Mexico",
          "status": "approved",
          "order_date": "2023-11-05",
          "delivery_date": "2023-11-08"
        },
        {
          "id": 7,
          "customer_id": 7,
          "amount": 320,
          "city": "Chicago",
          "country": "USA",
          "status": "approved",
          "order_date": "2023-08-22",
          "delivery_date": "2023-08-25"
        },
        {
          "id": 8,
          "customer_id": 8,
          "amount": 90,
          "city": "Vancouver",
          "country": "Canada",
          "status": "pending",
          "order_date": "2023-12-10",
          "delivery_date": null
        },
        {
          "id": 9,
          "customer_id": 9,
          "amount": 410,
          "city": "Guadalajara",
          "country": "Mexico",
          "status": "approved",
          "order_date": "2023-04-15",
          "delivery_date": "2023-04-20"
        },
        {
          "id": 10,
          "customer_id": 1,
          "amount": 280,
          "city": "NYC",
          "country": "USA",
          "status": "approved",
          "order_date": "2023-09-01",
          "delivery_date": "2023-09-04"
        },
        {
          "id": 11,
          "customer_id": 5,
          "amount": 180,
          "city": "Rio",
          "country": "Brazil",
          "status": "approved",
          "order_date": "2023-07-30",
          "delivery_date": "2023-08-02"
        },
        {
          "id": 13,
          "customer_id": 2,
          "amount": 75,
          "city": "LA",
          "country": "USA",
          "status": "approved",
          "order_date": "2023-03-05",
          "delivery_date": "2023-03-08"
        },
        {
          "id": 15,
          "customer_id": 3,
          "amount": 250,
          "city": "Montreal",
          "country": "Canada",
          "status": "approved",
          "order_date": "2023-10-12",
          "delivery_date": "2023-10-15"
        },
        {
          "id": 16,
          "customer_id": 7,
          "amount": 420,
          "city": "Boston",
          "country": "USA",
          "status": "approved",
          "order_date": "2023-05-18",
          "delivery_date": "2023-05-22"
        },
        {
          "id": 17,
          "customer_id": 8,
          "amount": 110,
          "city": "Calgary",
          "country": "Canada",
          "status": "approved",
          "order_date": "2023-11-28",
          "delivery_date": "2023-12-01"
        },
        {
          "id": 19,
          "customer_id": 6,
          "amount": 310,
          "city": "Mendoza",
          "country": "Argentina",
          "status": "approved",
          "order_date": "2023-08-10",
          "delivery_date": "2023-08-14"
        },
        {
          "id": 20,
          "customer_id": 1,
          "amount": 480,
          "city": "NYC",
          "country": "USA",
          "status": "approved",
          "order_date": "2023-12-25",
          "delivery_date": "2023-12-28"
        },
        {
          "id": 22,
          "customer_id": 3,
          "amount": 160,
          "city": "Toronto",
          "country": "Canada",
          "status": "approved",
          "order_date": "2023-02-14",
          "delivery_date": "2023-02-17"
        }
      ],
      "validation": {
        "order_matters": false
      },
      "success_criteria": {
        "objective": "Return 2023 orders",
        "expected_columns": [
          "id",
          "customer_id",
          "amount",
          "city",
          "country",
          "status",
          "order_date",
          "delivery_date"
        ],
        "notes": []
      },
      "hint_level_1": "Use BETWEEN with date strings.",
      "hint_level_2": "WHERE order_date BETWEEN '2023-01-01' AND '2023-12-31'"
    },
    {
      "id": "ch3_between_and",
      "title": "Challenge 3: BETWEEN and AND",
      "prompt_markdown": "### Objective\nReturn rows from filtering.orders where amount is between 200 and 400 AND status = 'approved'.",
      "starter_query": "-- (editor vazio)",
      "solution_query": "SELECT *\nFROM filtering.orders\nWHERE amount BETWEEN 200 AND 400 AND status = 'approved';",
      "validation_type": "result_match",
      "expected_result": [
        {
          "id": 3,
          "customer_id": 3,
          "amount": 350,
          "city": "Toronto",
          "country": "Canada",
          "status": "approved",
          "order_date": "2023-06-20",
          "delivery_date": "2023-06-25"
        },
        {
          "id": 7,
          "customer_id": 7,
          "amount": 320,
          "city": "Chicago",
          "country": "USA",
          "status": "approved",
          "order_date": "2023-08-22",
          "delivery_date": "2023-08-25"
        },
        {
          "id": 10,
          "customer_id": 1,
          "amount": 280,
          "city": "NYC",
          "country": "USA",
          "status": "approved",
          "order_date": "2023-09-01",
          "delivery_date": "2023-09-04"
        },
        {
          "id": 12,
          "customer_id": 6,
          "amount": 380,
          "city": "Cordoba",
          "country": "Argentina",
          "status": "approved",
          "order_date": "2024-01-20",
          "delivery_date": "2024-01-24"
        },
        {
          "id": 15,
          "customer_id": 3,
          "amount": 250,
          "city": "Montreal",
          "country": "Canada",
          "status": "approved",
          "order_date": "2023-10-12",
          "delivery_date": "2023-10-15"
        },
        {
          "id": 19,
          "customer_id": 6,
          "amount": 310,
          "city": "Mendoza",
          "country": "Argentina",
          "status": "approved",
          "order_date": "2023-08-10",
          "delivery_date": "2023-08-14"
        }
      ],
      "validation": {
        "order_matters": false
      },
      "success_criteria": {
        "objective": "Return approved orders with amount 200-400",
        "expected_columns": [
          "id",
          "customer_id",
          "amount",
          "city",
          "country",
          "status",
          "order_date",
          "delivery_date"
        ],
        "notes": []
      },
      "hint_level_1": "Combine BETWEEN with AND.",
      "hint_level_2": "WHERE amount BETWEEN 200 AND 400 AND status = 'approved'"
    }
  ]
}
